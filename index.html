<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Primary Meta Tags -->
    <title>The Minuecus Post - El Peri√≥dico Oficial de la Rep√∫blica</title>
    <meta name="title" content="The Minuecus Post - El Peri√≥dico Oficial de la Rep√∫blica">
    <meta name="description" content="Noticias, opini√≥n y an√°lisis de la Rep√∫blica de Minueco. Cobertura completa del gobierno, pol√≠tica, econom√≠a y m√°s.">
    <meta name="keywords" content="Minueco, noticias, rep√∫blica, gobierno, pol√≠tica, The Minuecus Post">
    <meta name="author" content="The Minuecus Post">
    <meta name="robots" content="index, follow">
    <meta name="language" content="Spanish">
    
    <!-- Theme Color -->
    <meta name="theme-color" content="#121212">
    <meta name="msapplication-TileColor" content="#121212">
    
    <!-- Favicons -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="manifest" href="site.webmanifest">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://yoaoxd.github.io/minueco-post/">
    <meta property="og:title" content="The Minuecus Post - El Peri√≥dico Oficial de la Rep√∫blica">
    <meta property="og:description" content="Noticias, opini√≥n y an√°lisis de la Rep√∫blica de Minueco. Cobertura completa del gobierno, pol√≠tica, econom√≠a y m√°s.">
    <meta property="og:image" content="https://yoaoxd.github.io/minueco-post/og-image.svg">
    <meta property="og:locale" content="es_ES">
    <meta property="og:site_name" content="The Minuecus Post">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://yoaoxd.github.io/minueco-post/">
    <meta name="twitter:title" content="The Minuecus Post - El Peri√≥dico Oficial de la Rep√∫blica">
    <meta name="twitter:description" content="Noticias, opini√≥n y an√°lisis de la Rep√∫blica de Minueco. Cobertura completa del gobierno, pol√≠tica, econom√≠a y m√°s.">
    <meta name="twitter:image" content="https://yoaoxd.github.io/minueco-post/og-image.svg">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://yoaoxd.github.io/minueco-post/">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Old+Standard+TT:wght@400;700&family=Source+Serif+Pro:wght@400;600;700&family=Source+Sans+Pro:wght@400;600;700&family=UnifrakturMaguntia&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Article Detail Modal -->
    <div class="modal-overlay" id="modal-overlay">
        <div class="modal">
            <button class="modal-close" id="modal-close">&times;</button>
            <article class="modal-content" id="modal-content">
                <!-- Populated by JS -->
            </article>
        </div>
    </div>

    <!-- Breaking News Banner (Marquee) -->
    <div class="breaking-banner" id="breaking-banner" style="display: none;">
        <span class="breaking-label">URGENTE</span>
        <div class="marquee-container">
            <span class="breaking-text marquee" id="breaking-text"></span>
        </div>
    </div>

    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-top">
                <div class="header-left">
                    <span class="edition">Edici√≥n Rep√∫blica</span>
                    <div class="header-widgets">
                        <div class="weather-widget" id="weather-widget">
                            <span class="weather-icon" id="weather-icon"></span>
                            <span class="weather-temp" id="weather-temp"></span>
                        </div>
                        <div class="dollar-rate" id="dollar-rate">
                            <span class="dollar-label">D√≥lar:</span>
                            <span class="dollar-value" id="dollar-value"></span>
                        </div>
                    </div>
                </div>
                <div class="header-center">
                    <a href="#" class="logo-link" id="home-link">
                        <h1 class="logo">The Minuecus Post</h1>
                    </a>
                    <p class="tagline" id="tagline"></p>
                </div>
                <div class="header-right">
                    <span class="date" id="pub-date"></span>
                </div>
            </div>
            <nav class="nav">
                <ul class="nav-list" id="nav-list">
                    <!-- Populated by JS -->
                </ul>
            </nav>
        </header>

        <!-- Live Updates Banner -->
        <div class="live-updates" id="live-updates" style="display: none;">
            <span class="live-dot"></span>
            <span class="live-label">EN VIVO</span>
            <span class="live-text" id="live-text"></span>
            <span class="live-time" id="live-time"></span>
        </div>

        <!-- Ad Banner -->
        <div class="ad-banner" id="ad-banner">
            <!-- Populated by JS -->
        </div>

        <!-- Main Content -->
        <main class="main">
            <!-- Featured + Opinion Section -->
            <div class="featured-section">
                <article class="featured" id="featured">
                    <!-- Populated by JS -->
                </article>
                <aside class="opinion-sidebar">
                    <h2 class="section-title">Opini√≥n</h2>
                    <div class="opinion-list" id="opinion">
                        <!-- Populated by JS -->
                    </div>
                    <div class="load-more-opinion" id="load-more-opinion-container">
                        <button class="load-more-opinion-btn" id="load-more-opinion-btn">Ver m√°s opini√≥n</button>
                    </div>
                </aside>
            </div>

            <!-- Top Stories Grid -->
            <section class="top-stories">
                <div class="stories-grid" id="top-stories">
                    <!-- Populated by JS -->
                </div>
                <div class="load-more-container" id="load-more-container">
                    <button class="load-more-btn" id="load-more-btn">Ver m√°s noticias</button>
                </div>
            </section>

            <!-- More Headlines + Sidebar -->
            <div class="bottom-section">
                <section class="more-stories" id="more-stories-section">
                    <h2 class="section-title">M√°s Noticias</h2>
                    <div class="headlines-list" id="more-stories">
                        <!-- Populated by JS -->
                    </div>
                </section>

                <aside class="sidebar">
                    <!-- Poll Widget -->
                    <div class="poll-widget" id="poll-widget">
                        <h3 class="widget-title">Encuesta del D√≠a</h3>
                        <p class="poll-question" id="poll-question"></p>
                        <div class="poll-options" id="poll-options">
                            <!-- Populated by JS -->
                        </div>
                        <p class="poll-total" id="poll-total"></p>
                    </div>

                    <!-- Newsletter -->
                    <div class="newsletter-widget" id="newsletter-widget">
                        <h3 class="widget-title" id="newsletter-title"></h3>
                        <p class="newsletter-desc" id="newsletter-desc"></p>
                        <div class="newsletter-form">
                            <input type="email" placeholder="tu@correo.com" class="newsletter-input">
                            <button class="newsletter-btn" id="newsletter-btn"></button>
                        </div>
                    </div>
                </aside>
            </div>
        </main>

        <!-- Pre-Footer Ad Banner -->
        <div class="ad-banner pre-footer-ad" id="pre-footer-ad">
            <!-- Populated by JS -->
        </div>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <p class="footer-logo">The Minuecus Post</p>
                <div class="footer-links">
                    <a href="#">T√©rminos</a>
                    <a href="#">Privacidad</a>
                    <a href="#">Contacto</a>
                    <a href="#">Publicidad</a>
                    <a href="#">Suscripciones</a>
                </div>
                <div class="footer-social">
                    <span>S√≠guenos:</span>
                    <a href="#" class="social-link">üìß</a>
                    <a href="#" class="social-link">üì±</a>
                    <a href="#" class="social-link">üåê</a>
                </div>
                <p class="footer-text">¬© 2026 The Minuecus Post. El peri√≥dico oficial de la Rep√∫blica de Minueco.</p>
                <p class="footer-text">Informaci√≥n institucional al servicio de la ciudadan√≠a.</p>
            </div>
        </footer>
    </div>

    <script>
        let newsData = null;
        let allStories = [];
        let allOpinions = [];
        let currentPage = 0;
        let currentOpinionPage = 0;
        const STORIES_PER_PAGE = 9;
        const OPINIONS_PER_PAGE = 3;
        const BASE_URL = 'https://yoaoxd.github.io/minueco-post/';

        // Fetch and render news
        async function loadNews() {
            try {
                const response = await fetch('news.json');
                newsData = await response.json();
                renderPage(newsData);
                
                // Check for article in URL hash
                checkUrlForArticle();
            } catch (error) {
                console.error('Error loading news:', error);
            }
        }

        function checkUrlForArticle() {
            const hash = window.location.hash;
            if (hash && hash.startsWith('#article-')) {
                const id = parseInt(hash.replace('#article-', ''));
                if (id) openArticle(id);
            }
        }

        function getArticleUrl(id) {
            return `${BASE_URL}#article-${id}`;
        }

        function shareArticle(id, e) {
            if (e) e.stopPropagation();
            const article = findArticleById(id);
            if (!article) return;
            
            const url = getArticleUrl(id);
            const text = article.headline;
            
            if (navigator.share) {
                navigator.share({ title: text, url: url });
            } else {
                navigator.clipboard.writeText(url);
                alert('Enlace copiado al portapapeles');
            }
        }

        function shareWhatsApp(id, e) {
            if (e) e.stopPropagation();
            const article = findArticleById(id);
            if (!article) return;
            
            const url = getArticleUrl(id);
            const text = encodeURIComponent(`üì∞ *${article.headline}*\n\n${article.summary}\n\nüîó ${url}\n\n_The Minuecus Post_`);
            window.open(`https://wa.me/?text=${text}`, '_blank');
        }

        function formatTime(timestamp) {
            const date = new Date(timestamp);
            const now = new Date();
            const diffHours = Math.floor((now - date) / (1000 * 60 * 60));
            
            if (diffHours < 1) return 'Ahora mismo';
            if (diffHours < 24) return `Hace ${diffHours}h`;
            return date.toLocaleDateString('es-ES', { month: 'short', day: 'numeric' });
        }

        function formatFullDate(timestamp) {
            const date = new Date(timestamp);
            return date.toLocaleDateString('es-ES', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        function getAllArticles() {
            if (!newsData) return [];
            return [
                newsData.featured,
                ...newsData.topStories,
                ...newsData.moreStories,
                ...newsData.opinion
            ];
        }

        function findArticleById(id) {
            return getAllArticles().find(article => article.id === id);
        }

        function openArticle(id) {
            const article = findArticleById(id);
            if (!article) return;

            // Update URL hash
            window.location.hash = `article-${id}`;

            const modalContent = document.getElementById('modal-content');
            modalContent.innerHTML = `
                ${article.image ? `<img class="modal-image" src="${article.image}" alt="${article.headline}">` : ''}
                <span class="modal-category">${article.category}</span>
                <h1 class="modal-headline">${article.headline}</h1>
                <div class="modal-meta">
                    <span class="modal-author">Por <strong>${article.author}</strong></span>
                    ${article.role ? `<span class="modal-role">${article.role}</span>` : ''}
                    <span class="modal-date">${formatFullDate(article.timestamp)}</span>
                    <span class="modal-read-time">${article.readTime} de lectura</span>
                </div>
                <div class="modal-share">
                    <button class="share-btn" onclick="shareArticle(${id})"><span>üîó</span> Compartir</button>
                    <button class="share-btn whatsapp" onclick="shareWhatsApp(${id})"><span>üì±</span> WhatsApp</button>
                </div>
                <div class="modal-body">
                    <p class="modal-summary">${article.summary}</p>
                    ${article.content ? `<p>${article.content}</p>` : ''}
                    ${!article.content ? generateFakeContent(article) : ''}
                </div>
                <div class="modal-footer">
                    <p class="modal-disclaimer">Publicaci√≥n oficial de la Rep√∫blica de Minueco.</p>
                </div>
            `;

            document.getElementById('modal-overlay').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            document.getElementById('modal-overlay').classList.remove('active');
            document.body.style.overflow = '';
            // Clear hash without scrolling
            history.pushState('', document.title, window.location.pathname + window.location.search);
        }

        function renderStories() {
            const container = document.getElementById('top-stories');
            const loadMoreBtn = document.getElementById('load-more-container');
            const moreStoriesSection = document.getElementById('more-stories-section');
            const moreStoriesContainer = document.getElementById('more-stories');
            
            const endIndex = (currentPage + 1) * STORIES_PER_PAGE;
            const storiesInGrid = allStories.slice(0, endIndex);
            const remainingStories = allStories.slice(endIndex);
            
            // Render grid stories
            container.innerHTML = storiesInGrid.map(story => `
                <article class="story-card clickable" data-id="${story.id}">
                    ${story.image ? `<img class="story-image" src="${story.image}" alt="${story.headline}">` : ''}
                    <span class="category">${story.category}</span>
                    <h3 class="story-headline">${story.headline}</h3>
                    <p class="story-summary">${story.summary}</p>
                    <div class="meta">
                        <span class="author">Por ${story.author}</span>
                        <span class="timestamp">${formatTime(story.timestamp)}</span>
                    </div>
                </article>
            `).join('');
            
            // Hide button if no more stories to load
            if (endIndex >= allStories.length) {
                loadMoreBtn.style.display = 'none';
            } else {
                loadMoreBtn.style.display = 'flex';
            }
            
            // Render remaining stories in "M√°s Noticias" section
            if (remainingStories.length > 0) {
                moreStoriesSection.style.display = 'block';
                moreStoriesContainer.innerHTML = remainingStories.map(story => `
                    <article class="headline-item clickable" data-id="${story.id}">
                        ${story.image ? `<img class="headline-image" src="${story.image}" alt="${story.headline}">` : ''}
                        <div class="headline-text">
                            <span class="category">${story.category}</span>
                            <h4 class="headline-title">${story.headline}</h4>
                            <div class="meta">
                                <span class="timestamp">${formatTime(story.timestamp)}</span>
                            </div>
                        </div>
                    </article>
                `).join('');
            } else {
                moreStoriesSection.style.display = 'none';
            }
            
            // Re-add click handlers for all clickable elements
            document.querySelectorAll('.clickable').forEach(el => {
                el.addEventListener('click', () => {
                    const id = parseInt(el.dataset.id);
                    openArticle(id);
                });
            });
        }

        function loadMoreStories() {
            currentPage++;
            renderStories();
        }

        function renderOpinions() {
            const container = document.getElementById('opinion');
            const loadMoreBtn = document.getElementById('load-more-opinion-container');
            
            const endIndex = (currentOpinionPage + 1) * OPINIONS_PER_PAGE;
            const opinionsToShow = allOpinions.slice(0, endIndex);
            
            container.innerHTML = opinionsToShow.map(story => `
                <article class="opinion-item clickable" data-id="${story.id}">
                    <h4 class="opinion-title">${story.headline}</h4>
                    <p class="opinion-summary">${story.summary}</p>
                    <div class="meta">
                        <span class="author">${story.author}</span>
                    </div>
                </article>
            `).join('');
            
            // Hide button if no more opinions
            if (endIndex >= allOpinions.length) {
                loadMoreBtn.style.display = 'none';
            } else {
                loadMoreBtn.style.display = 'block';
            }
            
            // Re-add click handlers
            container.querySelectorAll('.clickable').forEach(el => {
                el.addEventListener('click', () => {
                    const id = parseInt(el.dataset.id);
                    openArticle(id);
                });
            });
        }

        function loadMoreOpinions() {
            currentOpinionPage++;
            renderOpinions();
        }

        function renderPage(data) {
            // Publication info
            document.getElementById('tagline').textContent = data.publication.motto;
            document.getElementById('pub-date').textContent = data.publication.date;

            // Weather widget
            if (data.weather) {
                document.getElementById('weather-icon').textContent = data.weather.icon;
                document.getElementById('weather-temp').textContent = `${data.weather.temp}¬∞C`;
            }

            // Dollar rate
            if (data.finance) {
                const trendIcon = data.finance.trend === 'up' ? '‚Üë' : data.finance.trend === 'down' ? '‚Üì' : '';
                document.getElementById('dollar-value').textContent = `${data.finance.dollarRate} ${data.finance.currency} ${trendIcon}`;
            }

            // Live updates
            if (data.liveUpdates && data.liveUpdates.active) {
                const liveEl = document.getElementById('live-updates');
                document.getElementById('live-text').textContent = data.liveUpdates.story;
                document.getElementById('live-time').textContent = data.liveUpdates.lastUpdate;
                liveEl.style.display = 'flex';
            }

            // Ad banner
            if (data.ads && data.ads.length > 0) {
                const ad = data.ads.find(a => a.type === 'banner') || data.ads[0];
                document.getElementById('ad-banner').innerHTML = `
                    <div class="ad-content">
                        <span class="ad-label">PUBLICIDAD</span>
                        <div class="ad-main">
                            <span class="ad-title">${ad.title}</span>
                            <span class="ad-slogan">${ad.slogan}</span>
                            <span class="ad-description">${ad.description}</span>
                        </div>
                        <span class="ad-cta">${ad.cta} ‚Üí</span>
                    </div>
                `;
            }

            // Pre-footer Ad Banner
            const footerAd = data.ads ? data.ads.find(a => a.type === 'footer') : null;
            if (footerAd) {
                document.getElementById('pre-footer-ad').innerHTML = `
                    <div class="ad-content">
                        <span class="ad-label">PUBLICIDAD</span>
                        <div class="ad-main">
                            <span class="ad-title">${footerAd.title}</span>
                            <span class="ad-slogan">${footerAd.slogan}</span>
                            <span class="ad-description">${footerAd.description}</span>
                        </div>
                        <span class="ad-cta">${footerAd.cta} ‚Üí</span>
                    </div>
                `;
            } else {
                document.getElementById('pre-footer-ad').style.display = 'none';
            }

            // Poll widget
            if (data.poll) {
                document.getElementById('poll-question').textContent = data.poll.question;
                document.getElementById('poll-options').innerHTML = data.poll.options.map(opt => {
                    const percent = Math.round((opt.votes / data.poll.totalVotes) * 100);
                    return `
                        <div class="poll-option">
                            <div class="poll-option-text">${opt.text}</div>
                            <div class="poll-bar-container">
                                <div class="poll-bar" style="width: ${percent}%"></div>
                                <span class="poll-percent">${percent}%</span>
                            </div>
                        </div>
                    `;
                }).join('');
                document.getElementById('poll-total').textContent = `${data.poll.totalVotes.toLocaleString()} votos`;
            }

            // Newsletter
            if (data.newsletter) {
                document.getElementById('newsletter-title').textContent = data.newsletter.title;
                document.getElementById('newsletter-desc').textContent = data.newsletter.description;
                document.getElementById('newsletter-btn').textContent = data.newsletter.cta;
            }

            // Breaking news
            if (data.breaking && data.breaking.active) {
                const banner = document.getElementById('breaking-banner');
                document.getElementById('breaking-text').textContent = data.breaking.text;
                banner.style.display = 'flex';
            }

            // Navigation
            const navList = document.getElementById('nav-list');
            navList.innerHTML = data.sections.map(section => 
                `<li><a href="#${section.toLowerCase()}">${section}</a></li>`
            ).join('');

            // Featured story
            const featured = data.featured;
            document.getElementById('featured').innerHTML = `
                <div class="featured-content clickable" data-id="${featured.id}">
                    ${featured.image ? `<img class="featured-image" src="${featured.image}" alt="${featured.headline}">` : ''}
                    <div class="featured-text">
                        <span class="category">${featured.category}</span>
                        <h2 class="featured-headline">${featured.headline}</h2>
                        <p class="featured-summary">${featured.summary}</p>
                        <div class="meta">
                            <span class="author">Por ${featured.author}</span>
                            <span class="timestamp">${formatTime(featured.timestamp)}</span>
                            <span class="read-time">${featured.readTime} de lectura</span>
                        </div>
                        <span class="read-more">Leer art√≠culo completo ‚Üí</span>
                    </div>
                </div>
            `;

            // Combine all stories
            allStories = [...data.topStories, ...data.moreStories];
            currentPage = 0;
            
            // Render first page of stories
            renderStories();

            // Opinion - initialize and render
            allOpinions = [...data.opinion];
            currentOpinionPage = 0;
            renderOpinions();

            // Add click handlers
            document.querySelectorAll('.clickable').forEach(el => {
                el.addEventListener('click', () => {
                    const id = parseInt(el.dataset.id);
                    openArticle(id);
                });
            });
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', () => {
            loadNews();

            // Close modal
            document.getElementById('modal-close').addEventListener('click', closeModal);
            document.getElementById('modal-overlay').addEventListener('click', (e) => {
                if (e.target === e.currentTarget) closeModal();
            });

            // Close with Escape key
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') closeModal();
            });

            // Load more stories button
            document.getElementById('load-more-btn').addEventListener('click', loadMoreStories);

            // Load more opinion button
            document.getElementById('load-more-opinion-btn').addEventListener('click', loadMoreOpinions);

            // Handle browser back/forward
            window.addEventListener('hashchange', () => {
                const hash = window.location.hash;
                if (hash && hash.startsWith('#article-')) {
                    const id = parseInt(hash.replace('#article-', ''));
                    if (id) openArticle(id);
                } else {
                    closeModal();
                }
            });
        });
    </script>
</body>
</html>
